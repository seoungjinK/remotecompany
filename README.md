# TheMoon - ì‚¬ë‚´ ë©”ì‹ ì € ë° ì›ê²© ê·¼ë¬´ ê´€ë¦¬ ì‹œìŠ¤í…œ

> **MFCì™€ GDI+ë¥¼ í™œìš©í•˜ì—¬ êµ¬ì¶•í•œ ê³ ì„±ëŠ¥ Windows ë°ìŠ¤í¬í†± ë©”ì‹ ì € ë° í˜‘ì—… í”Œë«í¼** > Flask ê¸°ë°˜ì˜ REST API ì„œë²„ì™€ ì—°ë™í•˜ì—¬ ì‹¤ì‹œê°„ ì†Œí†µ ë° ì—…ë¬´ ê´€ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.
---
##  í”„ë¡œì íŠ¸ ê°œìš”
**TheMoon**ì€ ê¸°ì—… ë‚´ ì›í™œí•œ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ê³¼ ì›ê²© ê·¼ë¬´ ê´€ë¦¬ë¥¼ ìœ„í•´ ê°œë°œëœ í†µí•© ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.  
ê¸°ì¡´ MFC ì»¨íŠ¸ë¡¤ì˜ UIì  í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ **GDI+ Owner Draw** ê¸°ìˆ ì„ ì „ë©´ ë„ì…í•˜ì—¬ ì‚¬ìš©ì ì¹œí™”ì ì¸ UI/UXë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ë˜í•œ, ì•ˆì •ì ì¸ ë°ì´í„° ë™ê¸°í™”ë¥¼ ìœ„í•´ **REST API ê¸°ë°˜ì˜ ë¹„ë™ê¸° í´ë§(Polling)** ì•„í‚¤í…ì²˜ë¥¼ ì±„íƒí–ˆìŠµë‹ˆë‹¤.

##  ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

| êµ¬ë¶„ | ê¸°ìˆ  ìŠ¤íƒ |
| :--- | :--- |
| **Client** | Visual C++, MFC, GDI+, C++ REST SDK (cpprest) |
| **Server** | Python (Flask), Socket.IO |
| **Database** | MySQL |
| **Web Admin** | HTML5, CSS3, JavaScript, Socket.IO Client |
| **Tools** | Visual Studio 2019, Git |

---

## ì£¼ìš” ê¸°ëŠ¥ ë° ë‹´ë‹¹ ì—­í•  (Key Features)

### 1. ì‚¬ë‚´ ë©”ì‹ ì € (Corporate Messenger)
* **ë¹„ë™ê¸° ë°ì´í„° í†µì‹ :** ì†Œì¼“ ì—°ê²°ì˜ ë³µì¡ì„±ì„ ì¤„ì´ê³  ë°©í™”ë²½ ì´ìŠˆë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ `SetTimer`ì™€ `C++ REST SDK`ë¥¼ í™œìš©í•œ **2ì´ˆ ë‹¨ìœ„ HTTP Polling** êµ¬ì¡° ì„¤ê³„. ì„œë²„ ë¶€í•˜ë¥¼ ì¤„ì´ë©´ì„œ ì‹¤ì‹œê°„ì„±ì— ì¤€í•˜ëŠ” ë©”ì‹œì§€ ë™ê¸°í™” êµ¬í˜„.
* **GDI+ ì»¤ìŠ¤í…€ UI:** MFC ê¸°ë³¸ ì»¨íŠ¸ë¡¤(`CListCtrl`)ì„ ë°°ì œí•˜ê³  **GDI+**ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§í’ì„ (Bubble) UI, í”„ë¡œí•„ ì´ë¯¸ì§€ ë§ˆìŠ¤í‚¹ ë“±ì„ ì§ì ‘ ë“œë¡œì‰(Owner Draw)í•˜ì—¬ ì§ê´€ì  UX ì œê³µ.
* **ì›¹-ì•± ì—°ë™ (SSO):** Custom URI Scheme(`themoon-mfc://`)ì„ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡í•˜ê³  **JWT í† í°**ì„ íŒŒì‹±í•˜ì—¬, ì›¹ ëŒ€ì‹œë³´ë“œì—ì„œ ë³„ë„ ë¡œê·¸ì¸ ì—†ì´ ë©”ì‹ ì €ë¥¼ ì¦‰ì‹œ ì‹¤í–‰í•˜ëŠ” ì—°ë™ ê¸°ëŠ¥ êµ¬í˜„.

### 2. ì‚¬ì› ëª©ë¡ ë° ì¡°ì§ë„ (Contact List)
* **ê³„ì¸µí˜• ë¶€ì„œ ë¦¬ìŠ¤íŠ¸:** `std::map` ìë£Œêµ¬ì¡°ë¥¼ í™œìš©í•´ ë¶€ì„œë³„ë¡œ ì‚¬ì›ì„ ê·¸ë£¹í™”í•˜ê³ , **GDI+**ë¡œ í—¤ë”ì™€ ë¦¬ìŠ¤íŠ¸ë¥¼ ë Œë”ë§.
* **DB íŠ¸ëœì­ì…˜ ê¸°ë°˜ ì±„íŒ… ì—°ê²°:** 1:1 ì±„íŒ… ì‹œ `BeginTrans` ~ `CommitTrans`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì±„íŒ…ë°© ìƒì„± ë° ì°¸ì—¬ì ì´ˆëŒ€ë¥¼ ì›ìì (Atomic)ìœ¼ë¡œ ì²˜ë¦¬, ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥.
* **ì‹¤ì‹œê°„ ê²€ìƒ‰:** ê²€ìƒ‰ì–´ ì…ë ¥ ì‹œ ê¹œë¹¡ì„ ì—†ì´ ì¦‰ê°ì ìœ¼ë¡œ í•„í„°ë§ë˜ëŠ” ì¸ë©”ëª¨ë¦¬ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ ì ìš©. ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°”(`SCROLLINFO`) ë¡œì§ ì§ì ‘ êµ¬í˜„.

### 3. ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ (Community Board)
* **RESTful API ì—°ë™:** `GET`, `POST` ë©”ì„œë“œë¥¼ í†µí•œ ê²Œì‹œê¸€ CRUD êµ¬í˜„. JSON ë°ì´í„° íŒŒì‹± ë° **UTF-8 ì¸ì½”ë”©** ì²˜ë¦¬ë¥¼ í†µí•´ í•œê¸€ í˜¸í™˜ì„± í™•ë³´.
* **Flicker-Free UI:** ë¦¬ìŠ¤íŠ¸ ê°±ì‹  ì‹œ ë°œìƒí•˜ëŠ” í™”ë©´ ê¹œë¹¡ì„ì„ ì œê±°í•˜ê¸° ìœ„í•´ ë©”ëª¨ë¦¬ DCë¥¼ í™œìš©í•œ **ë”ë¸” ë²„í¼ë§(Double Buffering)** ê¸°ë²• ì ìš©.

---

## ê¸°ìˆ ì  ë„ì „ê³¼ í•´ê²° (Technical Challenges)

### Q1. ì†Œì¼“(Socket) ëŒ€ì‹  í´ë§(Polling)ì„ ì„ íƒí•œ ì´ìœ ëŠ”?
> **Challenge:** ì´ˆê¸°ì—ëŠ” ì†Œì¼“ í†µì‹ ì„ ê³ ë ¤í–ˆìœ¼ë‚˜, ì‚¬ë‚´ë§ ë°©í™”ë²½ ë¬¸ì œì™€ ì—°ê²° ìœ ì§€(Keep-alive)ì— ë”°ë¥¸ ì„œë²„ ë¦¬ì†ŒìŠ¤ ë¹„ìš©ì´ ìš°ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤.  
> **Solution:** í…ìŠ¤íŠ¸ ìœ„ì£¼ì˜ ë©”ì‹ ì € íŠ¹ì„±ìƒ 1~2ì´ˆì˜ ë”œë ˆì´ëŠ” ì¹˜ëª…ì ì´ì§€ ì•Šë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤. ì´ì— **REST API ê¸°ë°˜ì˜ Short Polling** ë°©ì‹ì„ ì±„íƒí•˜ì—¬ ì‹œìŠ¤í…œ ë³µì¡ë„ë¥¼ ë‚®ì¶”ê³  ìœ ì§€ë³´ìˆ˜ ìš©ì´ì„±ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” `task` ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í†µí•´ UI Freezingì„ ë°©ì§€í–ˆìŠµë‹ˆë‹¤.

### Q2. MFCì˜ íˆ¬ë°•í•œ UIë¥¼ ì–´ë–»ê²Œ ê°œì„ í–ˆëŠ”ê°€?
> **Challenge:** MFCì˜ ê¸°ë³¸ ì»¨íŠ¸ë¡¤ì€ ìŠ¤íƒ€ì¼ë§ì— ì œì•½ì´ ë§ì•„ í˜„ëŒ€ì ì¸ ë©”ì‹ ì € UIë¥¼ êµ¬í˜„í•˜ê¸° ì–´ë ¤ì› ìŠµë‹ˆë‹¤.  
> **Solution:** `OnPaint` ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ì—ì„œ **GDI+** ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ ëª¨ë“  UI ìš”ì†Œ(ë²„íŠ¼, ë¦¬ìŠ¤íŠ¸, ìŠ¤í¬ë¡¤ë°”)ë¥¼ ì§ì ‘ ê·¸ë ¸ìŠµë‹ˆë‹¤. í…ìŠ¤íŠ¸ì—ëŠ” `Anti-aliasing`ì„ ì ìš©í•´ ê°€ë…ì„±ì„ ë†’ì˜€ê³ , **ë”ë¸” ë²„í¼ë§**ì„ í†µí•´ ë Œë”ë§ ì„±ëŠ¥ì„ ìµœì í™”í–ˆìŠµë‹ˆë‹¤.

### Q3. ë°°í¬ ì‹œ ì‚¬ìš©ì í¸ì˜ì„±ì€?
> **Challenge:** ì›¹ ê¸°ë°˜ ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ë°ìŠ¤í¬í†± ì•±ì„ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ìš”êµ¬ì‚¬í•­ì´ ìˆì—ˆìŠµë‹ˆë‹¤.  
> **Solution:** ì„¤ì¹˜ íŒŒì¼ ì œì‘ ì‹œ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— **Custom URI Scheme**ì„ ë“±ë¡í•˜ë„ë¡ í•˜ì—¬
##  ì‹œìŠ¤í…œ íë¦„ë„ (Architecture)

### 1. í•˜ë“œì›¨ì–´ íë¦„ë„

> [!NOTE]
> 
> ![í•˜ë“œì›¨ì–´ íë¦„ë„](./image/í•˜ë“œì›¨ì–´íë¦„ë„.png)
> 

### 2. ì†Œí”„íŠ¸ì›¨ì–´ íë¦„ë„

> [!NOTE]
> 
> ![ì†Œí”„íŠ¸ì›¨ì–´ íë¦„ë„](image/ì†Œí”„íŠ¸ì›¨ì–´íë¦„ë„.png)



### 3. ì „ì²´ ì‹œìŠ¤í…œ íë¦„ë„

> [!NOTE]
> 
> ![ì „ì²´ íë¦„ë„](/image/íë¦„ë„.png)


---

## ğŸ“¸ ìŠ¤í¬ë¦°ìƒ· (Screenshots)

> [!NOTE]
> 

* **ë¡œê·¸ì¸ í˜ì´ì§€**
    ![ë¡œê·¸ì¸ í™”ë©´](./image/ë¡œê·¸ì¸.png)
* **íšŒì›ê°€ì… í˜ì´ì§€**
    ![íšŒì›ê°€ì… í™”ë©´](./image/íšŒì›ê°€ì….png)
* **ë©”ì¸ í˜ì´ì§€**
    ![ë©”ì¸ í™”ë©´](./image/ë©”ì¸ì°½.png)
* **ì–¼êµ´ ë“±ë¡ í˜ì´ì§€**
    ![ë©”ì¸ë“±ë¡ í™”ë©´](./image/ì–¼êµ´ë“±ë¡.png)
* **ì–¼êµ´ì¸ì‹ í˜ì´ì§€**
    ![ì–¼êµ´ ì¸ì‹](./image/ì–¼êµ´ì¸ì‹.png)
* **ì—…ë¬´ì²˜ë¦¬ í˜ì´ì§€**
    ![ì—…ë¬´ ì²˜ë¦¬](./image/ì—…ë¬´ì²˜ë¦¬.png)
* **ì»¤ë®¤ë‹ˆí‹° í˜ì´ì§€**
    ![ì»¤ë®¤ë‹ˆí‹°](./image/ì»¤ë®¤ë‹ˆí‹°.png)
* **ë©”ì„¸ì§€ í˜ì´ì§€**
    ![ë©”ì„¸ì§€](./image/ë©”ì„¸ì§€.png)
* **ì‚¬ì›ì°½ í˜ì´ì§€**
    ![ì‚¬ì›ì°½](./image/ì‚¬ì›ì°½.png)
* **ì¡¸ìŒê°ì§€ ê¸°ëŠ¥**
    ![ì¡¸ìŒê°ì§€](./image/ì¡¸ìŒê°ì§€.png)

---

## âš™ï¸ ì„¤ì¹˜ ë° ì‹¤í–‰ ë°©ë²• (Optional)

1.  **ë¦¬í¬ì§€í† ë¦¬ í´ë¡ :**
    ```bash
    git clone [https://github.com/your-username/your-repository-name.git](https://github.com/your-username/your-repository-name.git)
    cd your-repository-name
    ```

2.  **ê°€ìƒ í™˜ê²½ ìƒì„± ë° í™œì„±í™”:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # (Windows: venv\Scripts\activate)
    ```

3.  **í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •:**
    * MySQLì— `your_database_name` ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    * `config.py` (ë˜ëŠ” í•´ë‹¹ ì„¤ì • íŒŒì¼)ì— DB ì •ë³´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

5.  **ì•„ë‘ì´ë…¸ íŒì›¨ì–´ ì—…ë¡œë“œ:**
    * `arduino_code/` í´ë”ì˜ `.ino` íŒŒì¼ì„ ì•„ë‘ì´ë…¸ì— ì—…ë¡œë“œí•©ë‹ˆë‹¤.

6.  **Flask ì„œë²„ ì‹¤í–‰:**
    ```bash
    flask run
    ```
